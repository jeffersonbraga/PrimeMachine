package br.com.opsocial.server.utils.reports.xls;

import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Map;

import javax.servlet.ServletContext;

import org.apache.commons.lang3.RandomStringUtils;
import org.apache.poi.common.usermodel.Hyperlink;
import org.apache.poi.hssf.usermodel.HSSFPalette;
import org.apache.poi.hssf.usermodel.HSSFWorkbook;
import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.CellStyle;
import org.apache.poi.ss.usermodel.CreationHelper;
import org.apache.poi.ss.usermodel.Font;
import org.apache.poi.ss.usermodel.IndexedColors;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.ss.util.CellRangeAddress;
import org.springframework.beans.factory.annotation.Autowired;

import br.com.opsocial.OpSocialBackApplication;
import br.com.opsocial.client.entity.report.instagram.FilterLikesCommentsDTO;
import br.com.opsocial.client.entity.report.instagram.InstagramInteractionRankingDTO;
import br.com.opsocial.client.entity.report.instagram.InstagramReportPostDTO;
import br.com.opsocial.client.entity.report.instagram.InstagramTopPostTagDTO;
import br.com.opsocial.client.entity.report.instagram.ReportInstagramHistoricalDTO;
import br.com.opsocial.server.services.ServicesImpl;
import br.com.opsocial.server.utils.Calc;
import br.com.opsocial.server.utils.UtilFunctions;
import br.com.opsocial.server.utils.UtilFunctionsService;
import br.com.opsocial.ejb.entity.application.Profile;

public class ReportInstagramHistoricalXLS {

	private ReportInstagramHistoricalDTO reportInstagramHistorical;
	private Profile profile;

	private String reportsPath;
	private String fileName;
	private String formattedFileName;

	private HSSFWorkbook wb;
	private Sheet sheetHistorical;
	private Sheet sheetMetricsPerHour;

	private CreationHelper createHelper;

	private CellStyle cellStyleHeader;
	private CellStyle cellStyleHeaderData;
	private CellStyle cellStyleHeaderDataPositive;
	private CellStyle cellStyleHeaderDataNegative;
	private CellStyle cellSecondaryHeaderData;
	private CellStyle cellSecondaryHeaderNumber;
	private CellStyle cellSecondaryHeaderCenter;
	private CellStyle cellDateStyle;
	private CellStyle cellStylePreAnalysis;
	private CellStyle cellStylePreAnalysisResult;
	private CellStyle cellStyleHLink;
	private CellStyle cellDataPercentage;

	private Font fontHeader;
	private Font fontHeaderData;

	private Float headerDataRowHeight;
	
	private int rowSheetHistoricalCount;
	private int rowSheetMetricsPerHourCount;
	
	@Autowired
    UtilFunctionsService utilFunctionsService;
	
	public ReportInstagramHistoricalXLS(ReportInstagramHistoricalDTO reportInstagramHistorical, Profile profile) {
		this.reportInstagramHistorical = reportInstagramHistorical;
		this.profile = profile;
	}
	
	public void createXLS() {
		
		wb = new HSSFWorkbook();
		
		initiateDefautStyles();
		
		this.reportsPath = OpSocialBackApplication.GET_DIR_REPORTS_XLS;
		this.fileName = String.valueOf(RandomStringUtils.randomAlphanumeric(8) + ".xls");
		
		sheetHistorical = wb.createSheet("Instagram Histórico");
		sheetMetricsPerHour = wb.createSheet("Horários");
		
		headerDataRowHeight = 1.2F * sheetHistorical.getDefaultRowHeightInPoints();
		
		addMainHeader(sheetHistorical, profile.getScreenName() + " - Relatório Instagram - Histórico", 4);
		
		rowSheetHistoricalCount = 2;
		
		addAccountSummary();
		addPostsThroughoutTime();
		addPostsDensityDay();
		addPostsDensityHour();
		addLikesStats();
		addPostsWithMoreLikes();
		addCommentsStats();
		addPostsWithMoreComments();
		addFilterPostsStats();
		addFilterLikesComments();
		addTopPostTags();
		
		sheetHistorical.setDefaultColumnWidth(25);
		sheetHistorical.setColumnWidth(0, 10000);
		
		addMainHeader(sheetMetricsPerHour, profile.getScreenName() + " - Relatório Instagram - Histórico", 6);
		
		rowSheetMetricsPerHourCount = 2;
		
		addLikesPerHour();
		addCommentsPerHour();
		addInteractionsPerHour();
		
		sheetMetricsPerHour.setDefaultColumnWidth(25);
		sheetMetricsPerHour.setColumnWidth(0, 10000);
		
		try {
			
			File reportFile = new File(reportsPath, fileName);
			FileOutputStream fileOut = new FileOutputStream(reportFile);
			wb.write(fileOut);
			fileOut.close();
			
			formattedFileName = profile.getScreenName() + "-instagram-historico";
			
		} catch (FileNotFoundException e) {
			e.printStackTrace();
		} catch (IOException e) {
			e.printStackTrace();
		}
		
	}
	
	private void addInteractionsPerHour() {
		
		rowSheetMetricsPerHourCount += 2;
		
		Row rowInteractionsPerHourTitle = sheetMetricsPerHour.createRow(rowSheetMetricsPerHourCount);
		rowInteractionsPerHourTitle.setHeightInPoints(headerDataRowHeight);
		
		Cell cellInteractionsPerHourTitle = rowInteractionsPerHourTitle.createCell(0);
		cellInteractionsPerHourTitle.setCellValue("INTERAÇÕES TOTAIS POR HORÁRIO");
		cellInteractionsPerHourTitle.setCellStyle(cellStyleHeaderData);
		
		sheetMetricsPerHour.addMergedRegion(new CellRangeAddress(rowSheetMetricsPerHourCount, rowSheetMetricsPerHourCount, 0, 4));
		
		rowSheetMetricsPerHourCount++;
		Row rowInteractionsPerHourTitleItems = sheetMetricsPerHour.createRow(rowSheetMetricsPerHourCount);
		rowInteractionsPerHourTitleItems.setHeightInPoints(headerDataRowHeight);
		
		Cell cellInteractionsHourTitle = rowInteractionsPerHourTitleItems.createCell(0);
		cellInteractionsHourTitle.setCellValue("Horário");
		cellInteractionsHourTitle.setCellStyle(cellSecondaryHeaderData);
		
		Cell cellInteractionsTotalTitle = rowInteractionsPerHourTitleItems.createCell(1);
		cellInteractionsTotalTitle.setCellValue("Interações totais");
		cellInteractionsTotalTitle.setCellStyle(cellSecondaryHeaderNumber);
		
		rowSheetMetricsPerHourCount++;
		for(Map.Entry<Integer, Long> interactionsPerHour : reportInstagramHistorical.getInteractionsPerHour().entrySet()) {
			
			Row rowInteractionsPerHourValues = sheetMetricsPerHour.createRow(rowSheetMetricsPerHourCount);

			Cell cellInteractionsHourValue = rowInteractionsPerHourValues.createCell(0);
			cellInteractionsHourValue.setCellValue(new SimpleDateFormat("HH:mm").format(new Date(0, 0, 0, interactionsPerHour.getKey(), 0)) + " - " +
					new SimpleDateFormat("HH:mm").format(new Date(0, 0, 0, interactionsPerHour.getKey() + 1, 0)));
			
			Cell cellInteractionsTotalValue = rowInteractionsPerHourValues.createCell(1);
			cellInteractionsTotalValue.setCellValue(interactionsPerHour.getValue());

			rowSheetMetricsPerHourCount++;
		}
		
		int i = 1;
		for(InstagramInteractionRankingDTO instagramInteractionRanking : reportInstagramHistorical.getInstagramInteractionsRanking()) {

			if(i < 4) {
				
				rowSheetMetricsPerHourCount++;
				Row rowTimeMoreInteractions = sheetMetricsPerHour.createRow(rowSheetMetricsPerHourCount);
				rowTimeMoreInteractions.setHeightInPoints(headerDataRowHeight);
				
				Cell cellTimeMoreInteractionsTitle = rowTimeMoreInteractions.createCell(0);
				cellTimeMoreInteractionsTitle.setCellValue(i + "° horário em interações");
				cellTimeMoreInteractionsTitle.setCellStyle(cellStylePreAnalysis);
				
				String timeMoreInteractionsFrom = new SimpleDateFormat("HH:mm").format(new Date(0, 0, 0, instagramInteractionRanking.getHour(), 0, 0));
				String timeMoreInteractionsUntil = new SimpleDateFormat("HH:mm").format(new Date(0, 0, 0, instagramInteractionRanking.getHour() + 1, 0, 0));
				
				Cell cellTimeMoreInteractionsValue = rowTimeMoreInteractions.createCell(1);
				cellTimeMoreInteractionsValue.setCellValue(timeMoreInteractionsFrom + " - " + timeMoreInteractionsUntil);
				cellTimeMoreInteractionsValue.setCellStyle(cellStylePreAnalysisResult);
				
				Cell cellTimeMoreInteractionsPerc = rowTimeMoreInteractions.createCell(2);
				cellTimeMoreInteractionsPerc.setCellValue(instagramInteractionRanking.getPercentage().toString().replace(".", ",") + "%");
				cellTimeMoreInteractionsPerc.setCellStyle(cellStylePreAnalysisResult);
				
			} else {
				break;
			}
			
			i++;
		}
		
	}
	
	private void addCommentsPerHour() {
		
		rowSheetMetricsPerHourCount += 2;
		
		Row rowCommentsPerHourTitle = sheetMetricsPerHour.createRow(rowSheetMetricsPerHourCount);
		rowCommentsPerHourTitle.setHeightInPoints(headerDataRowHeight);
		
		Cell cellCommentsPerHourTitle = rowCommentsPerHourTitle.createCell(0);
		cellCommentsPerHourTitle.setCellValue("COMENTÁRIOS POR HORÁRIO");
		cellCommentsPerHourTitle.setCellStyle(cellStyleHeaderData);
		
		sheetMetricsPerHour.addMergedRegion(new CellRangeAddress(rowSheetMetricsPerHourCount, rowSheetMetricsPerHourCount, 0, 4));
		
		rowSheetMetricsPerHourCount++;
		Row rowCommentsPerHourTitleItems = sheetMetricsPerHour.createRow(rowSheetMetricsPerHourCount);
		rowCommentsPerHourTitleItems.setHeightInPoints(headerDataRowHeight);
		
		Cell cellCommentsHourTitle = rowCommentsPerHourTitleItems.createCell(0);
		cellCommentsHourTitle.setCellValue("Horário");
		cellCommentsHourTitle.setCellStyle(cellSecondaryHeaderData);
		
		Cell cellCommentsTotalTitle = rowCommentsPerHourTitleItems.createCell(1);
		cellCommentsTotalTitle.setCellValue("Comentários");
		cellCommentsTotalTitle.setCellStyle(cellSecondaryHeaderNumber);
		
		rowSheetMetricsPerHourCount++;
		for(Map.Entry<Integer, Long> commentsPerHour : reportInstagramHistorical.getCommentsPerHour().entrySet()) {
			
			Row rowCommentsPerHourValues = sheetMetricsPerHour.createRow(rowSheetMetricsPerHourCount);

			Cell cellCommentsHourValue = rowCommentsPerHourValues.createCell(0);
			cellCommentsHourValue.setCellValue(new SimpleDateFormat("HH:mm").format(new Date(0, 0, 0, commentsPerHour.getKey(), 0)) + " - " +
					new SimpleDateFormat("HH:mm").format(new Date(0, 0, 0, commentsPerHour.getKey() + 1, 0)));
			
			Cell cellCommentsTotalValue = rowCommentsPerHourValues.createCell(1);
			cellCommentsTotalValue.setCellValue(commentsPerHour.getValue());

			rowSheetMetricsPerHourCount++;
		}
		
		rowSheetMetricsPerHourCount++;
		Row rowTimeMoreComments = sheetMetricsPerHour.createRow(rowSheetMetricsPerHourCount);
		rowTimeMoreComments.setHeightInPoints(headerDataRowHeight);
		
		Cell cellTimeMoreCommentsTitle = rowTimeMoreComments.createCell(0);
		cellTimeMoreCommentsTitle.setCellValue("Horário com mais comentários:");
		cellTimeMoreCommentsTitle.setCellStyle(cellStylePreAnalysis);
		
		String timeMoreCommentsFrom = new SimpleDateFormat("HH:mm").format(new Date(0, 0, 0, reportInstagramHistorical.getTimeWithMoreComments(), 0, 0));
		String timeMoreCommentsUntil = new SimpleDateFormat("HH:mm").format(new Date(0, 0, 0, reportInstagramHistorical.getTimeWithMoreComments() + 1, 0, 0));
		
		Cell cellTimeMoreCommentsValue = rowTimeMoreComments.createCell(1);
		cellTimeMoreCommentsValue.setCellValue(timeMoreCommentsFrom + " - " + timeMoreCommentsUntil);
		cellTimeMoreCommentsValue.setCellStyle(cellStylePreAnalysisResult);
		
		Cell cellTimeMoreCommentsPerc = rowTimeMoreComments.createCell(2);
		cellTimeMoreCommentsPerc.setCellValue(reportInstagramHistorical.getTimeWithMoreCommentsPerc() + "%");
		cellTimeMoreCommentsPerc.setCellStyle(cellStylePreAnalysisResult);
		
		rowSheetMetricsPerHourCount++;
		Row rowTimeLessComments = sheetMetricsPerHour.createRow(rowSheetMetricsPerHourCount);
		rowTimeLessComments.setHeightInPoints(headerDataRowHeight);
		
		Cell cellTimeLessCommentsTitle = rowTimeLessComments.createCell(0);
		cellTimeLessCommentsTitle.setCellValue("Horário com menos comentários:");
		cellTimeLessCommentsTitle.setCellStyle(cellStylePreAnalysis);
		
		String timeLessCommentsFrom = new SimpleDateFormat("HH:mm").format(new Date(0, 0, 0, reportInstagramHistorical.getTimeWithLessComments(), 0, 0));
		String timeLessCommentsUntil = new SimpleDateFormat("HH:mm").format(new Date(0, 0, 0, reportInstagramHistorical.getTimeWithLessComments() + 1, 0, 0));
		
		Cell cellTimeLessCommentsValue = rowTimeLessComments.createCell(1);
		cellTimeLessCommentsValue.setCellValue(timeLessCommentsFrom + " - " + timeLessCommentsUntil);
		cellTimeLessCommentsValue.setCellStyle(cellStylePreAnalysisResult);
		
		Cell cellTimeLessCommentsPerc = rowTimeLessComments.createCell(2);
		cellTimeLessCommentsPerc.setCellValue(reportInstagramHistorical.getTimeWithLessCommentsPerc() + "%");
		cellTimeLessCommentsPerc.setCellStyle(cellStylePreAnalysisResult);
	}
	
	private void addLikesPerHour() {
		
		Row rowLikesPerHourTitle = sheetMetricsPerHour.createRow(rowSheetMetricsPerHourCount);
		rowLikesPerHourTitle.setHeightInPoints(headerDataRowHeight);
		
		Cell cellLikesPerHourTitle = rowLikesPerHourTitle.createCell(0);
		cellLikesPerHourTitle.setCellValue("LIKES POR HORÁRIO");
		cellLikesPerHourTitle.setCellStyle(cellStyleHeaderData);
		
		sheetMetricsPerHour.addMergedRegion(new CellRangeAddress(rowSheetMetricsPerHourCount, rowSheetMetricsPerHourCount, 0, 4));
		
		rowSheetMetricsPerHourCount++;
		Row rowLikesPerHourTitleItems = sheetMetricsPerHour.createRow(rowSheetMetricsPerHourCount);
		rowLikesPerHourTitleItems.setHeightInPoints(headerDataRowHeight);
		
		Cell cellLikesHourTitle = rowLikesPerHourTitleItems.createCell(0);
		cellLikesHourTitle.setCellValue("Horário");
		cellLikesHourTitle.setCellStyle(cellSecondaryHeaderData);
		
		Cell cellLikesTotalTitle = rowLikesPerHourTitleItems.createCell(1);
		cellLikesTotalTitle.setCellValue("Likes");
		cellLikesTotalTitle.setCellStyle(cellSecondaryHeaderNumber);
		
		rowSheetMetricsPerHourCount++;
		for(Map.Entry<Integer, Long> likesPerHour : reportInstagramHistorical.getLikesPerHour().entrySet()) {
			
			Row rowLikesPerHourValues = sheetMetricsPerHour.createRow(rowSheetMetricsPerHourCount);

			Cell cellLikesHourValue = rowLikesPerHourValues.createCell(0);
			cellLikesHourValue.setCellValue(new SimpleDateFormat("HH:mm").format(new Date(0, 0, 0, likesPerHour.getKey(), 0)) + " - " +
					new SimpleDateFormat("HH:mm").format(new Date(0, 0, 0, likesPerHour.getKey() + 1, 0)));
			
			Cell cellLikesTotalValue = rowLikesPerHourValues.createCell(1);
			cellLikesTotalValue.setCellValue(likesPerHour.getValue());

			rowSheetMetricsPerHourCount++;
		}
		
		rowSheetMetricsPerHourCount++;
		Row rowTimeMoreLikes = sheetMetricsPerHour.createRow(rowSheetMetricsPerHourCount);
		rowTimeMoreLikes.setHeightInPoints(headerDataRowHeight);
		
		Cell cellTimeMoreLikesTitle = rowTimeMoreLikes.createCell(0);
		cellTimeMoreLikesTitle.setCellValue("Horário com mais likes:");
		cellTimeMoreLikesTitle.setCellStyle(cellStylePreAnalysis);
		
		String timeMoreLikesFrom = new SimpleDateFormat("HH:mm").format(new Date(0, 0, 0, reportInstagramHistorical.getTimeWithMoreLikes(), 0, 0));
		String timeMoreLikesUntil = new SimpleDateFormat("HH:mm").format(new Date(0, 0, 0, reportInstagramHistorical.getTimeWithMoreLikes() + 1, 0, 0));
		
		Cell cellTimeMoreLikesValue = rowTimeMoreLikes.createCell(1);
		cellTimeMoreLikesValue.setCellValue(timeMoreLikesFrom + " - " + timeMoreLikesUntil);
		cellTimeMoreLikesValue.setCellStyle(cellStylePreAnalysisResult);
		
		Cell cellTimeMoreLikesPerc = rowTimeMoreLikes.createCell(2);
		cellTimeMoreLikesPerc.setCellValue(reportInstagramHistorical.getTimeWithMoreLikesPerc() + "%");
		cellTimeMoreLikesPerc.setCellStyle(cellStylePreAnalysisResult);
		
		rowSheetMetricsPerHourCount++;
		Row rowTimeLessLikes = sheetMetricsPerHour.createRow(rowSheetMetricsPerHourCount);
		rowTimeLessLikes.setHeightInPoints(headerDataRowHeight);
		
		Cell cellTimeLessLikesTitle = rowTimeLessLikes.createCell(0);
		cellTimeLessLikesTitle.setCellValue("Horário com menos likes:");
		cellTimeLessLikesTitle.setCellStyle(cellStylePreAnalysis);
		
		String timeLessLikesFrom = new SimpleDateFormat("HH:mm").format(new Date(0, 0, 0, reportInstagramHistorical.getTimeWithLessLikes(), 0, 0));
		String timeLessLikesUntil = new SimpleDateFormat("HH:mm").format(new Date(0, 0, 0, reportInstagramHistorical.getTimeWithLessLikes() + 1, 0, 0));
		
		Cell cellTimeLessLikesValue = rowTimeLessLikes.createCell(1);
		cellTimeLessLikesValue.setCellValue(timeLessLikesFrom + " - " + timeLessLikesUntil);
		cellTimeLessLikesValue.setCellStyle(cellStylePreAnalysisResult);
		
		Cell cellTimeLessLikesPerc = rowTimeLessLikes.createCell(2);
		cellTimeLessLikesPerc.setCellValue(reportInstagramHistorical.getTimeWithLessLikesPerc() + "%");
		cellTimeLessLikesPerc.setCellStyle(cellStylePreAnalysisResult);
	}
	
	private void addTopPostTags() {
		
		rowSheetHistoricalCount++;
		
		Row rowTopPostTagsTitle = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowTopPostTagsTitle.setHeightInPoints(headerDataRowHeight);
		
		Cell cellTopPostTagsTitle = rowTopPostTagsTitle.createCell(0);
		cellTopPostTagsTitle.setCellValue("HASHTAGS COM MAIS INTERAÇÕES");
		cellTopPostTagsTitle.setCellStyle(cellStyleHeaderData);
		
		sheetHistorical.addMergedRegion(new CellRangeAddress(rowSheetHistoricalCount, rowSheetHistoricalCount, 0, 4));
		
		rowSheetHistoricalCount++;
		Row rowTopPostTagsTitleItems = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowTopPostTagsTitleItems.setHeightInPoints(headerDataRowHeight);
		
		Cell cellTagNameTitle = rowTopPostTagsTitleItems.createCell(0);
		cellTagNameTitle.setCellValue("#Hashtag");
		cellTagNameTitle.setCellStyle(cellSecondaryHeaderData);
		
		Cell cellInteractionsTitle = rowTopPostTagsTitleItems.createCell(1);
		cellInteractionsTitle.setCellValue("Total de interações");
		cellInteractionsTitle.setCellStyle(cellSecondaryHeaderNumber);
		
		Cell cellTagLikesTitle = rowTopPostTagsTitleItems.createCell(2);
		cellTagLikesTitle.setCellValue("Likes");
		cellTagLikesTitle.setCellStyle(cellSecondaryHeaderNumber);
		
		Cell cellTagCommentsTitle = rowTopPostTagsTitleItems.createCell(3);
		cellTagCommentsTitle.setCellValue("Comentários");
		cellTagCommentsTitle.setCellStyle(cellSecondaryHeaderNumber);
		
		Cell cellInteractionsPercTitle = rowTopPostTagsTitleItems.createCell(4);
		cellInteractionsPercTitle.setCellValue("% do total");
		cellInteractionsPercTitle.setCellStyle(cellSecondaryHeaderNumber);
		
		rowSheetHistoricalCount++;
		for(InstagramTopPostTagDTO instagramTopPostTag : reportInstagramHistorical.getInstagramTopPostTags()) {
			
			Row rowTagValues = sheetHistorical.createRow(rowSheetHistoricalCount);

			Cell cellTagName = rowTagValues.createCell(0);
			cellTagName.setCellValue("#" + instagramTopPostTag.getTag().toUpperCase());
			
			Cell cellInteractions = rowTagValues.createCell(1);
			cellInteractions.setCellValue(instagramTopPostTag.getInteractions());
			
			Cell cellLikes = rowTagValues.createCell(2);
			cellLikes.setCellValue(instagramTopPostTag.getLikes());
			
			Cell cellComments = rowTagValues.createCell(3);
			cellComments.setCellValue(instagramTopPostTag.getComments());
			
			Cell cellInteractionsPerc = rowTagValues.createCell(4);
			cellInteractionsPerc.setCellValue(instagramTopPostTag.getInteractionsPercentage().toString().replace(".", ",") + "%");
			cellInteractionsPerc.setCellStyle(cellDataPercentage);
			
			rowSheetHistoricalCount++;
		}
	}
	
	private void addFilterLikesComments() {
		
		rowSheetHistoricalCount++;
		
		Row rowFilterLikesCommentsTitle = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowFilterLikesCommentsTitle.setHeightInPoints(headerDataRowHeight);
		
		Cell cellFilterLikesCommentsTitle = rowFilterLikesCommentsTitle.createCell(0);
		cellFilterLikesCommentsTitle.setCellValue("NÚMERO DE LIKES E COMENTÁRIOS POR FILTRO");
		cellFilterLikesCommentsTitle.setCellStyle(cellStyleHeaderData);
		
		sheetHistorical.addMergedRegion(new CellRangeAddress(rowSheetHistoricalCount, rowSheetHistoricalCount, 0, 4));
		
		rowSheetHistoricalCount++;
		Row rowFilterLikesCommentsTitleItems = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowFilterLikesCommentsTitleItems.setHeightInPoints(headerDataRowHeight);
		
		Cell cellFilterNameTitle = rowFilterLikesCommentsTitleItems.createCell(0);
		cellFilterNameTitle.setCellValue("Filtro");
		cellFilterNameTitle.setCellStyle(cellSecondaryHeaderData);
		
		Cell cellFilterLikesTitle = rowFilterLikesCommentsTitleItems.createCell(1);
		cellFilterLikesTitle.setCellValue("Total de likes");
		cellFilterLikesTitle.setCellStyle(cellSecondaryHeaderNumber);
		
		Cell cellFilterCommentsTitle = rowFilterLikesCommentsTitleItems.createCell(2);
		cellFilterCommentsTitle.setCellValue("Total de comentários");
		cellFilterCommentsTitle.setCellStyle(cellSecondaryHeaderNumber);
		
		rowSheetHistoricalCount++;
		for(FilterLikesCommentsDTO filterLikesComments : reportInstagramHistorical.getFiltersLikesComments()) {
			
			Row rowFilterValues = sheetHistorical.createRow(rowSheetHistoricalCount);
			
			Cell cellFilterName = rowFilterValues.createCell(0);
			cellFilterName.setCellValue(filterLikesComments.getFilter());
			
			Cell cellFilterLikes = rowFilterValues.createCell(1);
			cellFilterLikes.setCellValue(filterLikesComments.getLikes());
			
			Cell cellFilterComments = rowFilterValues.createCell(2);
			cellFilterComments.setCellValue(filterLikesComments.getComments());

			rowSheetHistoricalCount++;
		}
	}
	
	private void addFilterPostsStats() {
		
		rowSheetHistoricalCount++;
		
		Row rowFilterPostsStatsTitle = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowFilterPostsStatsTitle.setHeightInPoints(headerDataRowHeight);
		
		Cell cellFilterPostsStatsTitle = rowFilterPostsStatsTitle.createCell(0);
		cellFilterPostsStatsTitle.setCellValue("FILTROS MAIS USADOS");
		cellFilterPostsStatsTitle.setCellStyle(cellStyleHeaderData);
		
		sheetHistorical.addMergedRegion(new CellRangeAddress(rowSheetHistoricalCount, rowSheetHistoricalCount, 0, 4));
		
		rowSheetHistoricalCount++;
		Row rowFilterPostsStatsTitleItems = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowFilterPostsStatsTitleItems.setHeightInPoints(headerDataRowHeight);
		
		Cell cellFilterNameTitle = rowFilterPostsStatsTitleItems.createCell(0);
		cellFilterNameTitle.setCellValue("Filtro");
		cellFilterNameTitle.setCellStyle(cellSecondaryHeaderData);
		
		Cell cellFilterTotalTitle = rowFilterPostsStatsTitleItems.createCell(1);
		cellFilterTotalTitle.setCellValue("Total");
		cellFilterTotalTitle.setCellStyle(cellSecondaryHeaderNumber);
		
		Cell cellFilterTotalPercTitle = rowFilterPostsStatsTitleItems.createCell(2);
		cellFilterTotalPercTitle.setCellValue("%");
		cellFilterTotalPercTitle.setCellStyle(cellSecondaryHeaderNumber);
		
		rowSheetHistoricalCount++;
		for(Map.Entry<String, Long> filterCount : reportInstagramHistorical.getFiltersCounts().entrySet()) {
			
			Row rowFilterValues = sheetHistorical.createRow(rowSheetHistoricalCount);
			
			Cell cellFilterName = rowFilterValues.createCell(0);
			cellFilterName.setCellValue(filterCount.getKey());
			
			Cell cellFilterTotal = rowFilterValues.createCell(1);
			cellFilterTotal.setCellValue(filterCount.getValue());
			
			Cell cellFilterTotalPerc = rowFilterValues.createCell(2);
			cellFilterTotalPerc.setCellValue(
					Calc.calcPercentageNormal(filterCount.getValue().doubleValue(), reportInstagramHistorical.getPosts().doubleValue(), 2).
						toString().replace('.', ',') + "%");
			cellFilterTotalPerc.setCellStyle(cellDataPercentage);

			rowSheetHistoricalCount++;
		}
	}
	
	private void addPostsWithMoreComments() {
		
		rowSheetHistoricalCount += 2;
		
		Row rowPostsWithMoreCommentsTitle = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowPostsWithMoreCommentsTitle.setHeightInPoints(headerDataRowHeight);
		
		Cell cellPostsWithMoreCommentsTitle = rowPostsWithMoreCommentsTitle.createCell(0);
		cellPostsWithMoreCommentsTitle.setCellValue("POSTS COM MAIS COMENTÁRIOS");
		cellPostsWithMoreCommentsTitle.setCellStyle(cellStyleHeaderData);
		
		sheetHistorical.addMergedRegion(new CellRangeAddress(rowSheetHistoricalCount, rowSheetHistoricalCount, 0, 4));
		
		rowSheetHistoricalCount++;
		Row rowPostsWithMoreCommentsTitleItems = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowPostsWithMoreCommentsTitleItems.setHeightInPoints(headerDataRowHeight);
		
		Cell cellPostsLinkTitle = rowPostsWithMoreCommentsTitleItems.createCell(0);
		cellPostsLinkTitle.setCellValue("Post");
		cellPostsLinkTitle.setCellStyle(cellSecondaryHeaderData);
		
		Cell cellPostCommentsTitle = rowPostsWithMoreCommentsTitleItems.createCell(1);
		cellPostCommentsTitle.setCellValue("Total de comentários");
		cellPostCommentsTitle.setCellStyle(cellSecondaryHeaderNumber);
		
		rowSheetHistoricalCount++;
		for(InstagramReportPostDTO instagramReportPost : reportInstagramHistorical.getPostsWithMoreComments()) {
			
			Row rowPostValues = sheetHistorical.createRow(rowSheetHistoricalCount);
			
			Hyperlink hyperLink = createHelper.createHyperlink(Hyperlink.LINK_URL);
    		hyperLink.setAddress(instagramReportPost.getLink());
		
			Cell cellProfileLink = rowPostValues.createCell(0);
			cellProfileLink.setCellValue(instagramReportPost.getLink());
			cellProfileLink.setHyperlink((org.apache.poi.ss.usermodel.Hyperlink) hyperLink);
			cellProfileLink.setCellStyle(cellStyleHLink);
			
			Cell cellCommentsTotal = rowPostValues.createCell(1);
			cellCommentsTotal.setCellValue(instagramReportPost.getComments());

			rowSheetHistoricalCount++;
		}
	}
	
	private void addCommentsStats() {
		
		rowSheetHistoricalCount++;
		
		Row rowCommentsStatsTitle = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowCommentsStatsTitle.setHeightInPoints(headerDataRowHeight);
		
		Cell cellCommentsStatsTitle = rowCommentsStatsTitle.createCell(0);
		cellCommentsStatsTitle.setCellValue("COMENTÁRIOS POR MÊS");
		cellCommentsStatsTitle.setCellStyle(cellStyleHeaderData);
		
		sheetHistorical.addMergedRegion(new CellRangeAddress(rowSheetHistoricalCount, rowSheetHistoricalCount, 0, 4));
		
		rowSheetHistoricalCount++;
		Row rowCommentsStatsSubTitle = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowCommentsStatsSubTitle.setHeightInPoints(headerDataRowHeight);
		
		Cell cellCommentsStatsMonthTitle = rowCommentsStatsSubTitle.createCell(0);
		cellCommentsStatsMonthTitle.setCellValue("Mês");
		cellCommentsStatsMonthTitle.setCellStyle(cellSecondaryHeaderData);
		
		Cell cellCommentsStatsYearFirstTitle = rowCommentsStatsSubTitle.createCell(1);
		cellCommentsStatsYearFirstTitle.setCellValue(reportInstagramHistorical.getInstagramPostsStatsYearFirst().getYear());
		cellCommentsStatsYearFirstTitle.setCellStyle(cellSecondaryHeaderNumber);
		
		Cell cellCommentsStatsYearSecondTitle = rowCommentsStatsSubTitle.createCell(2);
		cellCommentsStatsYearSecondTitle.setCellValue(reportInstagramHistorical.getInstagramPostsStatsYearSecond().getYear());
		cellCommentsStatsYearSecondTitle.setCellStyle(cellSecondaryHeaderNumber);
		
		Cell cellCommentsStatsYearThirdTitle = rowCommentsStatsSubTitle.createCell(3);
		cellCommentsStatsYearThirdTitle.setCellValue(reportInstagramHistorical.getInstagramPostsStatsYearThird().getYear());
		cellCommentsStatsYearThirdTitle.setCellStyle(cellSecondaryHeaderNumber);
		
		rowSheetHistoricalCount++;
		for (int i = 1; i <= 12; i++) {
			
			Long commentsYearFirstValue = reportInstagramHistorical.getInstagramPostsStatsYearFirst().getCommentsPerMonth().containsKey(i) ? 
					reportInstagramHistorical.getInstagramPostsStatsYearFirst().getCommentsPerMonth().get(i) : 0L;
			Long commentsYearSecondValue = reportInstagramHistorical.getInstagramPostsStatsYearSecond().getCommentsPerMonth().containsKey(i) ? 
					reportInstagramHistorical.getInstagramPostsStatsYearSecond().getCommentsPerMonth().get(i) : 0L;
			Long commentsPostsYearThirdValue = reportInstagramHistorical.getInstagramPostsStatsYearThird().getCommentsPerMonth().containsKey(i) ? 
					reportInstagramHistorical.getInstagramPostsStatsYearThird().getCommentsPerMonth().get(i) : 0L;	
			
			Row rowCommentsStatsValues = sheetHistorical.createRow(rowSheetHistoricalCount);

			Cell cellCommentsStatsMonthValue = rowCommentsStatsValues.createCell(0);
			cellCommentsStatsMonthValue.setCellValue(utilFunctionsService.getFormattedMonth(i - 1));
			
			Cell cellCommentsStatsYearFirstValue = rowCommentsStatsValues.createCell(1);
			cellCommentsStatsYearFirstValue.setCellValue(commentsYearFirstValue);
			
			Cell cellCommentsStatsYearSecondValue = rowCommentsStatsValues.createCell(2);
			cellCommentsStatsYearSecondValue.setCellValue(commentsYearSecondValue);
			
			Cell cellCommentsStatsYearThirdValue = rowCommentsStatsValues.createCell(3);
			cellCommentsStatsYearThirdValue.setCellValue(commentsPostsYearThirdValue);
			
			rowSheetHistoricalCount++;
		}
		
		rowSheetHistoricalCount++;
		Row rowTotalComments = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowTotalComments.setHeightInPoints(headerDataRowHeight);
		
		Cell cellTotalCommentsTitle = rowTotalComments.createCell(0);
		cellTotalCommentsTitle.setCellValue("Total de comentários:");
		cellTotalCommentsTitle.setCellStyle(cellStylePreAnalysis);
		
		Cell cellTotalCommentsValue = rowTotalComments.createCell(1);
		cellTotalCommentsValue.setCellValue(reportInstagramHistorical.getComments());
		cellTotalCommentsValue.setCellStyle(cellStylePreAnalysisResult);
		
		rowSheetHistoricalCount++;
		Row rowAverageComments = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowAverageComments.setHeightInPoints(headerDataRowHeight);
		
		Cell cellAverageCommentsTitle = rowAverageComments.createCell(0);
		cellAverageCommentsTitle.setCellValue("Média de comentários por post:");
		cellAverageCommentsTitle.setCellStyle(cellStylePreAnalysis);
		
		Cell cellAverageCommentsValue = rowAverageComments.createCell(1);
		cellAverageCommentsValue.setCellValue(reportInstagramHistorical.getCommentsAverage().toString().replace(".", ","));
		cellAverageCommentsValue.setCellStyle(cellStylePreAnalysisResult);
		
		rowSheetHistoricalCount++;
		Row rowFollowersComments = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowFollowersComments.setHeightInPoints(headerDataRowHeight);
		
		Cell cellFollowersCommentsTitle = rowFollowersComments.createCell(0);
		cellFollowersCommentsTitle.setCellValue("Comentários de seguidores:");
		cellFollowersCommentsTitle.setCellStyle(cellStylePreAnalysis);
		
		Cell cellFollowersCommentsValue = rowFollowersComments.createCell(1);
		cellFollowersCommentsValue.setCellValue(reportInstagramHistorical.getCommentsFollowers() + "%");
		cellFollowersCommentsValue.setCellStyle(cellStylePreAnalysisResult);
		
		rowSheetHistoricalCount++;
		Row rowNoFollowersComments = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowNoFollowersComments.setHeightInPoints(headerDataRowHeight);
		
		Cell cellNoFollowersCommentsTitle = rowNoFollowersComments.createCell(0);
		cellNoFollowersCommentsTitle.setCellValue("Comentários de não-seguidores:");
		cellNoFollowersCommentsTitle.setCellStyle(cellStylePreAnalysis);
		
		Cell cellNoFollowersCommentsValue = rowNoFollowersComments.createCell(1);
		cellNoFollowersCommentsValue.setCellValue(reportInstagramHistorical.getCommentsNoFollowers() + "%");
		cellNoFollowersCommentsValue.setCellStyle(cellStylePreAnalysisResult);
	}
	
	private void addPostsWithMoreLikes() {
		
		rowSheetHistoricalCount += 2;
		
		Row rowPostsWithMoreLikesTitle = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowPostsWithMoreLikesTitle.setHeightInPoints(headerDataRowHeight);
		
		Cell cellPostsWithMoreLikesTitle = rowPostsWithMoreLikesTitle.createCell(0);
		cellPostsWithMoreLikesTitle.setCellValue("POSTS COM MAIS LIKES");
		cellPostsWithMoreLikesTitle.setCellStyle(cellStyleHeaderData);
		
		sheetHistorical.addMergedRegion(new CellRangeAddress(rowSheetHistoricalCount, rowSheetHistoricalCount, 0, 4));
		
		rowSheetHistoricalCount++;
		Row rowPostsWithMoreLikesTitleItems = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowPostsWithMoreLikesTitleItems.setHeightInPoints(headerDataRowHeight);
		
		Cell cellPostsLinkTitle = rowPostsWithMoreLikesTitleItems.createCell(0);
		cellPostsLinkTitle.setCellValue("Post");
		cellPostsLinkTitle.setCellStyle(cellSecondaryHeaderData);
		
		Cell cellPostLikesTitle = rowPostsWithMoreLikesTitleItems.createCell(1);
		cellPostLikesTitle.setCellValue("Total de likes");
		cellPostLikesTitle.setCellStyle(cellSecondaryHeaderNumber);
		
		rowSheetHistoricalCount++;
		for(InstagramReportPostDTO instagramReportPost : reportInstagramHistorical.getPostsWithMoreLikes()) {
			
			Row rowPostValues = sheetHistorical.createRow(rowSheetHistoricalCount);
			
			Hyperlink hyperLink = createHelper.createHyperlink(Hyperlink.LINK_URL);
    		hyperLink.setAddress(instagramReportPost.getLink());
		
			Cell cellProfileLink = rowPostValues.createCell(0);
			cellProfileLink.setCellValue(instagramReportPost.getLink());
			cellProfileLink.setHyperlink((org.apache.poi.ss.usermodel.Hyperlink) hyperLink);
			cellProfileLink.setCellStyle(cellStyleHLink);
			
			Cell cellLikesTotal = rowPostValues.createCell(1);
			cellLikesTotal.setCellValue(instagramReportPost.getLikes());

			rowSheetHistoricalCount++;
		}
	}
	
	private void addLikesStats() {
		
		rowSheetHistoricalCount++;
		
		Row rowLikesStatsTitle = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowLikesStatsTitle.setHeightInPoints(headerDataRowHeight);
		
		Cell cellLikesStatsTitle = rowLikesStatsTitle.createCell(0);
		cellLikesStatsTitle.setCellValue("LIKES POR MÊS");
		cellLikesStatsTitle.setCellStyle(cellStyleHeaderData);
		
		sheetHistorical.addMergedRegion(new CellRangeAddress(rowSheetHistoricalCount, rowSheetHistoricalCount, 0, 4));
		
		rowSheetHistoricalCount++;
		Row rowLikesStatsSubTitle = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowLikesStatsSubTitle.setHeightInPoints(headerDataRowHeight);
		
		Cell cellLikesStatsMonthTitle = rowLikesStatsSubTitle.createCell(0);
		cellLikesStatsMonthTitle.setCellValue("Mês");
		cellLikesStatsMonthTitle.setCellStyle(cellSecondaryHeaderData);
		
		Cell cellLikesStatsYearFirstTitle = rowLikesStatsSubTitle.createCell(1);
		cellLikesStatsYearFirstTitle.setCellValue(reportInstagramHistorical.getInstagramPostsStatsYearFirst().getYear());
		cellLikesStatsYearFirstTitle.setCellStyle(cellSecondaryHeaderNumber);
		
		Cell cellLikesStatsYearSecondTitle = rowLikesStatsSubTitle.createCell(2);
		cellLikesStatsYearSecondTitle.setCellValue(reportInstagramHistorical.getInstagramPostsStatsYearSecond().getYear());
		cellLikesStatsYearSecondTitle.setCellStyle(cellSecondaryHeaderNumber);
		
		Cell cellLikesStatsYearThirdTitle = rowLikesStatsSubTitle.createCell(3);
		cellLikesStatsYearThirdTitle.setCellValue(reportInstagramHistorical.getInstagramPostsStatsYearThird().getYear());
		cellLikesStatsYearThirdTitle.setCellStyle(cellSecondaryHeaderNumber);
		
		rowSheetHistoricalCount++;
		for (int i = 1; i <= 12; i++) {
			
			Long likesYearFirstValue = reportInstagramHistorical.getInstagramPostsStatsYearFirst().getLikesPerMonth().containsKey(i) ? 
					reportInstagramHistorical.getInstagramPostsStatsYearFirst().getLikesPerMonth().get(i) : 0L;
			Long likesYearSecondValue = reportInstagramHistorical.getInstagramPostsStatsYearSecond().getLikesPerMonth().containsKey(i) ? 
					reportInstagramHistorical.getInstagramPostsStatsYearSecond().getLikesPerMonth().get(i) : 0L;
			Long likesPostsYearThirdValue = reportInstagramHistorical.getInstagramPostsStatsYearThird().getLikesPerMonth().containsKey(i) ? 
					reportInstagramHistorical.getInstagramPostsStatsYearThird().getLikesPerMonth().get(i) : 0L;	
			
			Row rowLikesStatsValues = sheetHistorical.createRow(rowSheetHistoricalCount);

			Cell cellLikesStatsMonthValue = rowLikesStatsValues.createCell(0);
			cellLikesStatsMonthValue.setCellValue(utilFunctionsService.getFormattedMonth(i - 1));
			
			Cell cellLikesStatsYearFirstValue = rowLikesStatsValues.createCell(1);
			cellLikesStatsYearFirstValue.setCellValue(likesYearFirstValue);
			
			Cell cellLikesStatsYearSecondValue = rowLikesStatsValues.createCell(2);
			cellLikesStatsYearSecondValue.setCellValue(likesYearSecondValue);
			
			Cell cellLikesStatsYearThirdValue = rowLikesStatsValues.createCell(3);
			cellLikesStatsYearThirdValue.setCellValue(likesPostsYearThirdValue);
			
			rowSheetHistoricalCount++;
		}
		
		rowSheetHistoricalCount++;
		Row rowTotalLikes = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowTotalLikes.setHeightInPoints(headerDataRowHeight);
		
		Cell cellTotalLikesTitle = rowTotalLikes.createCell(0);
		cellTotalLikesTitle.setCellValue("Total de likes:");
		cellTotalLikesTitle.setCellStyle(cellStylePreAnalysis);
		
		Cell cellTotalLikesValue = rowTotalLikes.createCell(1);
		cellTotalLikesValue.setCellValue(reportInstagramHistorical.getLikes());
		cellTotalLikesValue.setCellStyle(cellStylePreAnalysisResult);
		
		rowSheetHistoricalCount++;
		Row rowAverageLikes = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowAverageLikes.setHeightInPoints(headerDataRowHeight);
		
		Cell cellAverageLikesTitle = rowAverageLikes.createCell(0);
		cellAverageLikesTitle.setCellValue("Média de likes por post:");
		cellAverageLikesTitle.setCellStyle(cellStylePreAnalysis);
		
		Cell cellAverageLikesValue = rowAverageLikes.createCell(1);
		cellAverageLikesValue.setCellValue(reportInstagramHistorical.getLikesAverage().toString().replace(".", ","));
		cellAverageLikesValue.setCellStyle(cellStylePreAnalysisResult);
		
		rowSheetHistoricalCount++;
		Row rowFollowersLikes = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowFollowersLikes.setHeightInPoints(headerDataRowHeight);
		
		Cell cellFollowersLikesTitle = rowFollowersLikes.createCell(0);
		cellFollowersLikesTitle.setCellValue("Likes de seguidores:");
		cellFollowersLikesTitle.setCellStyle(cellStylePreAnalysis);
		
		Cell cellFollowersLikesValue = rowFollowersLikes.createCell(1);
		cellFollowersLikesValue.setCellValue(reportInstagramHistorical.getLikesFollowers() + "%");
		cellFollowersLikesValue.setCellStyle(cellStylePreAnalysisResult);
		
		rowSheetHistoricalCount++;
		Row rowNoFollowersLikes = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowNoFollowersLikes.setHeightInPoints(headerDataRowHeight);
		
		Cell cellNoFollowersLikesTitle = rowNoFollowersLikes.createCell(0);
		cellNoFollowersLikesTitle.setCellValue("Likes de não-seguidores:");
		cellNoFollowersLikesTitle.setCellStyle(cellStylePreAnalysis);
		
		Cell cellNoFollowersLikesValue = rowNoFollowersLikes.createCell(1);
		cellNoFollowersLikesValue.setCellValue(reportInstagramHistorical.getLikesNoFollowers() + "%");
		cellNoFollowersLikesValue.setCellStyle(cellStylePreAnalysisResult);
	}
	
	private void addPostsDensityHour() {
		
		rowSheetHistoricalCount++;
		
		Row rowPostsDensityHourTitle = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowPostsDensityHourTitle.setHeightInPoints(headerDataRowHeight);
		
		Cell cellPostsDensityHourTitle = rowPostsDensityHourTitle.createCell(0);
		cellPostsDensityHourTitle.setCellValue("DENSIDADE DE POSTS POR HORÁRIO");
		cellPostsDensityHourTitle.setCellStyle(cellStyleHeaderData);
		
		sheetHistorical.addMergedRegion(new CellRangeAddress(rowSheetHistoricalCount, rowSheetHistoricalCount, 0, 4));
		
		rowSheetHistoricalCount++;
		Row rowPostsDensityHourSubTitle = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowPostsDensityHourSubTitle.setHeightInPoints(headerDataRowHeight);
		
		Cell cellPostDensityHourTitle = rowPostsDensityHourSubTitle.createCell(0);
		cellPostDensityHourTitle.setCellValue("Horário");
		cellPostDensityHourTitle.setCellStyle(cellSecondaryHeaderData);
		
		Cell cellPostsDensityHourTotalTitle = rowPostsDensityHourSubTitle.createCell(1);
		cellPostsDensityHourTotalTitle.setCellValue("Total de posts");
		cellPostsDensityHourTotalTitle.setCellStyle(cellSecondaryHeaderNumber);
		
		rowSheetHistoricalCount++;
		for(Map.Entry<Integer, Long> postsPerHour : reportInstagramHistorical.getPostsPerHour().entrySet()) {

			Row rowPostsDensityHourValues = sheetHistorical.createRow(rowSheetHistoricalCount);

			Cell cellPostsDensityHour = rowPostsDensityHourValues.createCell(0);
			cellPostsDensityHour.setCellValue(new SimpleDateFormat("HH:mm").format(new Date(0, 0, 0, postsPerHour.getKey(), 0)) + " - " +
					new SimpleDateFormat("HH:mm").format(new Date(0, 0, 0, postsPerHour.getKey() + 1, 0)));
			
			Cell cellPostsDensityHourValue = rowPostsDensityHourValues.createCell(1);
			cellPostsDensityHourValue.setCellValue(postsPerHour.getValue());
			
			rowSheetHistoricalCount++;
		}
	}
	
	private void addPostsDensityDay() {
		
		rowSheetHistoricalCount++;
		
		Row rowPostsDensityDayTitle = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowPostsDensityDayTitle.setHeightInPoints(headerDataRowHeight);
		
		Cell cellPostsDensityDayTitle = rowPostsDensityDayTitle.createCell(0);
		cellPostsDensityDayTitle.setCellValue("DENSIDADE DE POSTS POR DIA DA SEMANA");
		cellPostsDensityDayTitle.setCellStyle(cellStyleHeaderData);
		
		sheetHistorical.addMergedRegion(new CellRangeAddress(rowSheetHistoricalCount, rowSheetHistoricalCount, 0, 4));
		
		rowSheetHistoricalCount++;
		Row rowPostsDensityDaySubTitle = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowPostsDensityDaySubTitle.setHeightInPoints(headerDataRowHeight);
		
		Cell cellPostsDensityWeekDayTitle = rowPostsDensityDaySubTitle.createCell(0);
		cellPostsDensityWeekDayTitle.setCellValue("Dia da semana");
		cellPostsDensityWeekDayTitle.setCellStyle(cellSecondaryHeaderData);
		
		Cell cellPostsDensityWeekDayTotalTitle = rowPostsDensityDaySubTitle.createCell(1);
		cellPostsDensityWeekDayTotalTitle.setCellValue("Total de posts");
		cellPostsDensityWeekDayTotalTitle.setCellStyle(cellSecondaryHeaderNumber);
		
		rowSheetHistoricalCount++;
		for(Map.Entry<Integer, Long> postsPerWeekDay : reportInstagramHistorical.getPostsPerWeekDay().entrySet()) {

			Row rowPostsDensityDayValues = sheetHistorical.createRow(rowSheetHistoricalCount);

			Cell cellPostsDensityWeekDayValue = rowPostsDensityDayValues.createCell(0);
			cellPostsDensityWeekDayValue.setCellValue(utilFunctionsService.getFormattedWeekDayShort(postsPerWeekDay.getKey()));
			
			Cell cellPostsDensityDayValue = rowPostsDensityDayValues.createCell(1);
			cellPostsDensityDayValue.setCellValue(postsPerWeekDay.getValue());
			
			rowSheetHistoricalCount++;
		}
	}
	
	private void addPostsThroughoutTime() {
		
		rowSheetHistoricalCount += 2;
		
		Row rowPostsThroughoutTimeTitle = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowPostsThroughoutTimeTitle.setHeightInPoints(headerDataRowHeight);
		
		Cell cellPostsThroughoutTimeTitle = rowPostsThroughoutTimeTitle.createCell(0);
		cellPostsThroughoutTimeTitle.setCellValue("POSTS POR MÊS E ANO");
		cellPostsThroughoutTimeTitle.setCellStyle(cellStyleHeaderData);
		
		sheetHistorical.addMergedRegion(new CellRangeAddress(rowSheetHistoricalCount, rowSheetHistoricalCount, 0, 4));
		
		rowSheetHistoricalCount++;
		Row rowPostsThroughoutTimeSubTitle = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowPostsThroughoutTimeSubTitle.setHeightInPoints(headerDataRowHeight);
		
		Cell cellInstaPostsStatsMonthTitle = rowPostsThroughoutTimeSubTitle.createCell(0);
		cellInstaPostsStatsMonthTitle.setCellValue("Mês");
		cellInstaPostsStatsMonthTitle.setCellStyle(cellSecondaryHeaderData);
		
		Cell cellInstaPostsStatsYearFirstTitle = rowPostsThroughoutTimeSubTitle.createCell(1);
		cellInstaPostsStatsYearFirstTitle.setCellValue(reportInstagramHistorical.getInstagramPostsStatsYearFirst().getYear());
		cellInstaPostsStatsYearFirstTitle.setCellStyle(cellSecondaryHeaderNumber);
		
		Cell cellInstaPostsStatsYearSecondTitle = rowPostsThroughoutTimeSubTitle.createCell(2);
		cellInstaPostsStatsYearSecondTitle.setCellValue(reportInstagramHistorical.getInstagramPostsStatsYearSecond().getYear());
		cellInstaPostsStatsYearSecondTitle.setCellStyle(cellSecondaryHeaderNumber);
		
		Cell cellInstaPostsStatsYearThirdTitle = rowPostsThroughoutTimeSubTitle.createCell(3);
		cellInstaPostsStatsYearThirdTitle.setCellValue(reportInstagramHistorical.getInstagramPostsStatsYearThird().getYear());
		cellInstaPostsStatsYearThirdTitle.setCellStyle(cellSecondaryHeaderNumber);
		
		Cell cellInstaPostsStatsTotalTitle = rowPostsThroughoutTimeSubTitle.createCell(4);
		cellInstaPostsStatsTotalTitle.setCellValue("Total");
		cellInstaPostsStatsTotalTitle.setCellStyle(cellSecondaryHeaderNumber);
		
		rowSheetHistoricalCount++;
		for (int i = 1; i <= 12; i++) {
			
			Long instaPostsYearFirstValue = reportInstagramHistorical.getInstagramPostsStatsYearFirst().getPostsPerMonth().containsKey(i) ? 
					reportInstagramHistorical.getInstagramPostsStatsYearFirst().getPostsPerMonth().get(i) : 0L;
			Long instaPostsYearSecondValue = reportInstagramHistorical.getInstagramPostsStatsYearSecond().getPostsPerMonth().containsKey(i) ? 
					reportInstagramHistorical.getInstagramPostsStatsYearSecond().getPostsPerMonth().get(i) : 0L;
			Long instaPostsYearThirdValue = reportInstagramHistorical.getInstagramPostsStatsYearThird().getPostsPerMonth().containsKey(i) ? 
					reportInstagramHistorical.getInstagramPostsStatsYearThird().getPostsPerMonth().get(i) : 0L;	
					
			Long instaPostsStatsTotal = instaPostsYearFirstValue + instaPostsYearSecondValue + instaPostsYearThirdValue;
			
			Row rowInstaPostsStatsValues = sheetHistorical.createRow(rowSheetHistoricalCount);

			Cell cellInstaPostsStatsMonthValue = rowInstaPostsStatsValues.createCell(0);
			cellInstaPostsStatsMonthValue.setCellValue(utilFunctionsService.getFormattedMonth(i - 1));
			
			Cell cellInstaPostsStatsYearFirstValue = rowInstaPostsStatsValues.createCell(1);
			cellInstaPostsStatsYearFirstValue.setCellValue(instaPostsYearFirstValue);
			
			Cell cellInstaPostsStatsYearSecondValue = rowInstaPostsStatsValues.createCell(2);
			cellInstaPostsStatsYearSecondValue.setCellValue(instaPostsYearSecondValue);
			
			Cell cellInstaPostsStatsYearThirdValue = rowInstaPostsStatsValues.createCell(3);
			cellInstaPostsStatsYearThirdValue.setCellValue(instaPostsYearThirdValue);
			
			Cell cellInstaPostsStatsTotalValue = rowInstaPostsStatsValues.createCell(4);
			cellInstaPostsStatsTotalValue.setCellValue(instaPostsStatsTotal);
			
			rowSheetHistoricalCount++;
		}
		
	}
	
	private void addAccountSummary() {
		
		Row rowAccountSummaryTitle = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowAccountSummaryTitle.setHeightInPoints(headerDataRowHeight);
		
		Cell cellAccountSummaryTitle = rowAccountSummaryTitle.createCell(0);
		cellAccountSummaryTitle.setCellValue("RESUMO DA CONTA");
		cellAccountSummaryTitle.setCellStyle(cellStyleHeaderData);
		
		sheetHistorical.addMergedRegion(new CellRangeAddress(rowSheetHistoricalCount, rowSheetHistoricalCount, 0, 4));
		
		rowSheetHistoricalCount++;
		Row rowPostsActionsTitle = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowPostsActionsTitle.setHeightInPoints(headerDataRowHeight);
		
		Cell cellPostsActionsTitle = rowPostsActionsTitle.createCell(0);
		cellPostsActionsTitle.setCellValue("Total de posts");
		cellPostsActionsTitle.setCellStyle(cellSecondaryHeaderData);
		
		Cell cellPostsActionsValue = rowPostsActionsTitle.createCell(1);
		cellPostsActionsValue.setCellValue(reportInstagramHistorical.getPosts());
		
		rowSheetHistoricalCount++;
		Row rowFollowersTitle = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowFollowersTitle.setHeightInPoints(headerDataRowHeight);
		
		Cell cellFollowersTitle = rowFollowersTitle.createCell(0);
		cellFollowersTitle.setCellValue("Seguidores");
		cellFollowersTitle.setCellStyle(cellSecondaryHeaderData);
		
		Cell cellFollowersValue = rowFollowersTitle.createCell(1);
		cellFollowersValue.setCellValue(reportInstagramHistorical.getFollowers());
		
		rowSheetHistoricalCount++;
		Row rowFollowingsTitle = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowFollowingsTitle.setHeightInPoints(headerDataRowHeight);
		
		Cell cellFollowingsTitle = rowFollowingsTitle.createCell(0);
		cellFollowingsTitle.setCellValue("Seguindo");
		cellFollowingsTitle.setCellStyle(cellSecondaryHeaderData);
		
		Cell cellFollowingsValue = rowFollowingsTitle.createCell(1);
		cellFollowingsValue.setCellValue(profile.getFollows() != null ? profile.getFollows() : 0);
		
		rowSheetHistoricalCount++;
		Row rowLikesTitle = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowLikesTitle.setHeightInPoints(headerDataRowHeight);
		
		Cell cellLikesTitle = rowLikesTitle.createCell(0);
		cellLikesTitle.setCellValue("Curtir");
		cellLikesTitle.setCellStyle(cellSecondaryHeaderData);
		
		Cell cellLikesValue = rowLikesTitle.createCell(1);
		cellLikesValue.setCellValue(reportInstagramHistorical.getLikes());
		
		rowSheetHistoricalCount++;
		Row rowCommentsTitle = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowCommentsTitle.setHeightInPoints(headerDataRowHeight);
		
		Cell cellCommentsTitle = rowCommentsTitle.createCell(0);
		cellCommentsTitle.setCellValue("Comentários");
		cellCommentsTitle.setCellStyle(cellSecondaryHeaderData);
		
		Cell cellCommentsValue = rowCommentsTitle.createCell(1);
		cellCommentsValue.setCellValue(reportInstagramHistorical.getComments());
		
		rowSheetHistoricalCount++;
		Row rowFilterTitle = sheetHistorical.createRow(rowSheetHistoricalCount);
		rowFilterTitle.setHeightInPoints(headerDataRowHeight);
		
		Cell cellFilterTitle = rowFilterTitle.createCell(0);
		cellFilterTitle.setCellValue("Filtro mais usado");
		cellFilterTitle.setCellStyle(cellSecondaryHeaderData);
		
		Cell cellFilterValue = rowFilterTitle.createCell(1);
		cellFilterValue.setCellValue(reportInstagramHistorical.getFilterMostUsed());
		cellFilterValue.setCellStyle(cellDataPercentage);
	}
	
	private void addMainHeader(Sheet sheetDataPosts, String text, int untilColumn) {

		Row row = sheetDataPosts.createRow(0);
		row.setHeightInPoints((2 * sheetDataPosts.getDefaultRowHeightInPoints()));

		Cell cellURL = row.createCell(0);
		cellURL.setCellValue(text);
		cellURL.setCellStyle(cellStyleHeader);

		sheetDataPosts.addMergedRegion(new CellRangeAddress(0, 0, 0, untilColumn));
	}

	private void initiateDefautStyles() {

		fontHeader = wb.createFont();
		fontHeader.setFontHeightInPoints((short) 12);
		fontHeader.setBold(true);
		fontHeader.setColor(IndexedColors.WHITE.index);

		HSSFPalette palette = wb.getCustomPalette();
		palette.setColorAtIndex(IndexedColors.SKY_BLUE.index, (byte) 102, (byte) 153, (byte) 204);
		palette.setColorAtIndex(IndexedColors.YELLOW.index, (byte) 255, (byte) 211, (byte) 32);
		palette.setColorAtIndex(IndexedColors.GREEN.index, (byte) 174, (byte) 207, (byte) 0);

		cellStyleHeader = wb.createCellStyle();
		cellStyleHeader.setFillForegroundColor(IndexedColors.SKY_BLUE.index);
		cellStyleHeader.setFillPattern(CellStyle.SOLID_FOREGROUND);
		cellStyleHeader.setFont(fontHeader);
		cellStyleHeader.setBorderBottom(CellStyle.BORDER_THIN);
		cellStyleHeader.setBorderTop(CellStyle.BORDER_THIN);
		cellStyleHeader.setBorderLeft(CellStyle.BORDER_THIN);
		cellStyleHeader.setBorderRight(CellStyle.BORDER_THIN);
		cellStyleHeader.setVerticalAlignment(CellStyle.VERTICAL_CENTER);

		fontHeaderData = wb.createFont();
		fontHeaderData.setFontHeightInPoints((short) 11);
		fontHeaderData.setBold(true);

		cellStyleHeaderData = wb.createCellStyle();
		cellStyleHeaderData.setFillForegroundColor(IndexedColors.YELLOW.index);
		cellStyleHeaderData.setFillPattern(CellStyle.SOLID_FOREGROUND);
		cellStyleHeaderData.setFont(fontHeaderData);

		cellStyleHeaderDataPositive = wb.createCellStyle();
		cellStyleHeaderDataPositive.setFillForegroundColor(IndexedColors.GREEN.index);
		cellStyleHeaderDataPositive.setFillPattern(CellStyle.SOLID_FOREGROUND);
		cellStyleHeaderDataPositive.setFont(fontHeaderData);

		cellStyleHeaderDataNegative = wb.createCellStyle();
		cellStyleHeaderDataNegative.setFillForegroundColor(IndexedColors.RED.index);
		cellStyleHeaderDataNegative.setFillPattern(CellStyle.SOLID_FOREGROUND);
		cellStyleHeaderDataNegative.setFont(fontHeaderData);

		cellSecondaryHeaderData = wb.createCellStyle();
		cellSecondaryHeaderData.setFont(fontHeaderData);

		cellSecondaryHeaderNumber = wb.createCellStyle();
		cellSecondaryHeaderNumber.setFont(fontHeaderData);
		cellSecondaryHeaderNumber.setAlignment(CellStyle.ALIGN_RIGHT);

		cellSecondaryHeaderCenter = wb.createCellStyle();
		cellSecondaryHeaderCenter.setFont(fontHeaderData);
		cellSecondaryHeaderCenter.setAlignment(CellStyle.ALIGN_CENTER);

		cellStylePreAnalysis = wb.createCellStyle();
		cellStylePreAnalysis.setFillForegroundColor(IndexedColors.GREY_25_PERCENT.index);
		cellStylePreAnalysis.setFillPattern(CellStyle.SOLID_FOREGROUND);
		cellStylePreAnalysis.setFont(fontHeaderData);

		cellStylePreAnalysisResult = wb.createCellStyle();
		cellStylePreAnalysisResult.setFillForegroundColor(IndexedColors.GREY_25_PERCENT.index);
		cellStylePreAnalysisResult.setFillPattern(CellStyle.SOLID_FOREGROUND);
		cellStylePreAnalysisResult.setAlignment(CellStyle.ALIGN_RIGHT);

		createHelper = wb.getCreationHelper();

		cellDateStyle = wb.createCellStyle();
		cellDateStyle.setDataFormat(
				createHelper.createDataFormat().getFormat("dd/mm/yyyy hh:mm"));

		//by default hyperlinks are blue and underlined
		cellStyleHLink = wb.createCellStyle();

		Font fontHLink = wb.createFont();
		fontHLink.setUnderline(Font.U_SINGLE);
		fontHLink.setColor(IndexedColors.BLUE.getIndex());

		cellStyleHLink.setFont(fontHLink);

		cellDataPercentage = wb.createCellStyle();
		cellDataPercentage.setAlignment(CellStyle.ALIGN_RIGHT);
	}

	public String getFileName() {
		return fileName;
	}

	public void setFileName(String fileName) {
		this.fileName = fileName;
	}

	public String getFormattedFileName() {
		return formattedFileName;
	}

	public void setFormattedFileName(String formattedFileName) {
		this.formattedFileName = formattedFileName;
	}
	
}
